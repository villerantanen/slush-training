---

- step:
    name: Train1
    image: valohai/darknet:b61bcf5-cuda8.0-cudnn5-devel-ubuntu16.04
    command: 
      - set -x
      - tar xvf $VH_INPUTS_DIR/images/slush-20171116a.tar
      - mkdir  $VH_OUTPUTS_DIR/backup 
      - ln -s $VH_OUTPUTS_DIR/backup backup
      - ls -lah $VH_INPUTS_DIR/images/
      - ls -lah
      - /darknet/darknet detector train data/obj.data cfg/yolo-obj.cfg $VH_INPUTS_DIR/weights/darknet19_448.conv.23
    inputs:
      - name: images
        default: http://k.moonq.org/slush/slush-20171116a.tar
      - name: weights
        default: http://k.moonq.org/pub/darknet19_448.conv.23

- step:
    name: Train2-tiny
    image: valohai/darknet:b61bcf5-cuda8.0-cudnn5-devel-ubuntu16.04
    command: 
      - set -x
      - tar xvf $VH_INPUTS_DIR/images/20171117.tar
      - mkdir  $VH_OUTPUTS_DIR/backup 
      - ln -s $VH_OUTPUTS_DIR/backup backup
      - ls -lah $VH_INPUTS_DIR/images/
      - ls -lah
      - /darknet/darknet detector train data/obj.data cfg/yolo-tiny.cfg $VH_INPUTS_DIR/weights/yolo-tiny.weights
    inputs:
      - name: images
        default: http://k.moonq.org/slush/20171117.tar
      - name: weights
        default: http://k.moonq.org/pub/tiny-yolo.weights


